#!/usr/bin/env bash
set -euo pipefail

BRANCH=${BUILDKITE_BRANCH//\//_}
DESCRIBE=$(git describe)
for TAG in $BUILDKITE_BUILD_NUMBER $BUILDKITE_COMMIT $BRANCH $DESCRIBE; do
  docker tag ${BUILDKITE_PLUGIN_DOCKER_TAGS_REGISTRY}:${BUILDKITE_PLUGIN_DOCKER_TAGS_TAG} ${BUILDKITE_PLUGIN_DOCKER_TAGS_REGISTRY}:${TAG}
  docker push ${BUILDKITE_PLUGIN_DOCKER_TAGS_REGISTRY}:${TAG}
done
